
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>list Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="mux.html" />
    
    
    <link rel="prev" href="player.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../meta/">
            
                <a href="../../meta/">
            
                    
                    This document
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../../meta/compiling.html">
            
                <a href="../../meta/compiling.html">
            
                    
                    Compiling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../../meta/conventions.html">
            
                <a href="../../meta/conventions.html">
            
                    
                    Conventions
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../">
            
                <a href="../">
            
                    
                    Bifrost Protocol
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../msgproto.html">
            
                <a href="../msgproto.html">
            
                    
                    Message Protocol
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../core/">
            
                <a href="../core/">
            
                    
                    Core Protocol
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.2.1" data-path="../core/commands.html">
            
                <a href="../core/commands.html">
            
                    
                    Core Command Set
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="./">
            
                <a href="./">
            
                    
                    Roles
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="player.html">
            
                <a href="player.html">
            
                    
                    player/file
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.3.2" data-path="list.html">
            
                <a href="list.html">
            
                    
                    list
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.3" data-path="mux.html">
            
                <a href="mux.html">
            
                    
                    mux
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.4" data-path="tracklister.html">
            
                <a href="tracklister.html">
            
                    
                    tracklister
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3.5" data-path="db.html">
            
                <a href="db.html">
            
                    
                    db
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../../tests/">
            
                <a href="../../tests/">
            
                    
                    Compliance Tests
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../../tests/msgproto.html">
            
                <a href="../../tests/msgproto.html">
            
                    
                    Message Protocol
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../../impl/">
            
                <a href="../../impl/">
            
                    
                    Reference Implementations
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../../impl/rationale.html">
            
                <a href="../../impl/rationale.html">
            
                    
                    Rationale
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >list</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="list"><code>list</code></h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <code>list</code> <a href="../../GLOSSARY.html#role" class="glossary-term" title="A specific service in the Bifrost system.">role</a> maintains a playlist.</p>
</div>
<div class="paragraph">
<p>The playlist contains both <em>file items</em>, which represent
files available to load into the player, and <em>text items</em>, which
are comments that can be added into the playlist, but are not
loadable and will be skipped over by the playlist.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_items_specific_to_this_role">Items specific to this role</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_non_command_requirements">Non-command requirements</h3>
<div class="paragraph">
<p>Servers implementing <code>list</code> have the following requirements in addition to
providing the command interface below:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">File and text loads</dt>
<dd>
<p>Servers <strong>must</strong> allow both files and text items to be
enqueued, and <strong>must</strong> disregard text items for the purposes of
selection and auto-advancing.</p>
</dd>
<dt class="hdlist1">Player mounting</dt>
<dd>
<p>Servers <strong>must</strong> expose a <code>player/file</code> at the mount point <code>player</code>.
This player <strong>may</strong> be integrated into the <code>list</code>, so long as it obeys
the mounting protocol.  The player <strong>must</strong> be fully controllable through
the mounting protocol.</p>
</dd>
<dt class="hdlist1">Flexible player selection</dt>
<dd>
<p>Servers <strong>should</strong> allow the configurable selection of the
player instance to which it will attach by using the mounting protocol.
If the playlist spawns, or contains, its own player,
this <strong>may</strong> be disregarded.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_selection">Selection</h3>
<div class="paragraph">
<p>Playlists <strong>must</strong> record the currently selected item, and allow it to be
modified using the <code>select</code> request.  The current selection is visible through
the <code>SELECT</code> response, which is part of the dump format for a <code>list</code>.</p>
</div>
<div class="paragraph">
<p>Selections are zero-indexed, with the special selection <code>-1</code> representing a
lack of selection.</p>
</div>
<div class="paragraph">
<p>In addition to direct manipulation via a <code>select</code> request, the selection
<strong>must</strong> be changed in the following situations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the playlist receives an <code>EJECT</code> response from its player, the selection
becomes <code>-1</code>;</p>
</li>
<li>
<p>If the playlist receives an <code>FLOAD</code> response from the player, the selection
becomes <code>-1</code> if the response was generated by the playlist (has a tag
that the playlist has sent), and the index of the corresponding item in
the playlist otherwise (the playlist should keep note of which specific
item it was trying to <code>fload</code> into the player);</p>
</li>
<li>
<p>If the player disconnects, the selection becomes <code>-1</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_autoload_types">Autoload types</h3>
<div class="paragraph">
<p>Playlists <strong>may</strong> support autoloading of files when the underlying player
reports an <code>END</code>.  The following autoload types, used with <code>AUTO</code> and <code>auto</code>,
are standard (but optional):</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>off</code></dt>
<dd>
<p>No autoloading.  When a selected file <code>END</code>s, the selection does not change.
This <strong>should</strong> be assumed by the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a> to be the default behaviour.</p>
</dd>
<dt class="hdlist1"><code>drop</code></dt>
<dd>
<p>When a selected file <code>END</code>s, the selection is reset to <code>-1</code>.</p>
</dd>
<dt class="hdlist1"><code>next</code></dt>
<dd>
<p>When a selected file <code>END</code>s, the <em>file</em> with the lowest index greater than
the original file is selected.  If none exists, the selection is reset to
<code>-1</code>.</p>
</dd>
<dt class="hdlist1"><code>shuffle</code></dt>
<dd>
<p>In this mode, the <a href="../../GLOSSARY.html#server" class="glossary-term" title="A program that provides services.">server</a> maintains a list of hashes that is reset when a
<code>sel</code> command is received.  When a selected file <code>END</code>s, a random <em>file</em>
whose hash is not yet in the list is selected, and its hash stored in the list.
If all files in the playlist are stored in the list, the list is emptied and
the selection is reset to <code>-1</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If the default autoload type used by a playlist is not <code>off</code>, the user <strong>must</strong> be informed of this.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dump_format">Dump format</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The dump format for <code>list</code> is as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>AUTO</code> <em>autoload-type</em>.</p>
</li>
<li>
<p><code>COUNTL</code> <em>number-of-items</em>.</p>
</li>
<li>
<p>Item dump (see below) <strong>for each</strong> index from <code>0</code> to <em>number-of-items - 1</em>.</p>
</li>
<li>
<p><code>SEL</code> <em>index</em> <em>hash</em>.</p>
</li>
<li>
<p><code>ON</code> <em>player</em> <em>request&#x2026;&#x200B;</em> <strong>for each</strong> dump item from the player.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_item_dump_format">Item dump format</h3>
<div class="paragraph">
<p><strong>If</strong> item <em>index</em> is a file:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>FLOADL</code> <em>index</em> <em>hash</em> <em>absolute-path</em>;</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><strong>Else if</strong> item <em>index</em> is text:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>TLOADL</code> <em>index</em> <em>hash</em> <em>contents</em>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_commands">Commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>list</code> <a href="../../GLOSSARY.html#role" class="glossary-term" title="A specific service in the Bifrost system.">role</a> adds the following commands:</p>
</div>
<div class="sect2">
<h3 id="_responses">Responses</h3>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>AUTO</code> <em>autoload-type</em></dt>
<dd>
<p>The playlist is now using <em>autoload-type</em> as its autoload type.
If no <code>AUTO</code> is received, clients <strong>should</strong> assume no autoloading is
occurring</p>
</dd>
<dt class="hdlist1"><code>SEL</code> <em>index</em> <em>hash</em></dt>
<dd>
<p>If <em>index</em> is a non-negative number, the <em>file</em> at index <em>index</em> and with
hash <em>hash</em> is currently selected (and is, or will be, loaded into the
player).  If <em>index</em> is <code>-1</code>, no file is selected (and <em>hash</em> is
undefined).  If the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a> does not have an file with the given index or
hash, the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a> <strong>should</strong> request a <code>dump</code>.</p>
</dd>
<dt class="hdlist1"><code>COUNTL</code> <em>number-of-items</em></dt>
<dd>
<p>The playlist has <em>number-of-items</em> items enqueued.  If this number is
inconsistent with the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a>&#x2019;s expectations, the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a> <strong>should</strong>
request a <code>dump</code>.</p>
</dd>
<dt class="hdlist1"><code>FLOADL</code> <em>index</em> <em>hash</em> <em>absolute-path</em></dt>
<dd>
<p>The playlist has enqueued a file item at index <em>index</em> with the hash <em>hash</em>
and absolute path <em>absolute-path</em>.  The comments on indices above apply.</p>
</dd>
<dt class="hdlist1"><code>TLOADL</code> <em>index</em> <em>hash</em> <em>contents</em></dt>
<dd>
<p>The playlist has enqueued a text item at index <em>index</em> with the hash
<em>hash</em> and text <em>contents</em>.  If <em>index</em> is below the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a>&#x2019;s last
received <code>COUNTL</code>, the item previously at <em>index</em> has been replaced by this
new item.
If <em>index</em> is equal to the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a>&#x2019;s last received <code>COUNTL</code>, the
<a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a> <strong>should</strong> presume <code>COUNTL</code> has increased by one.  The <a href="../../GLOSSARY.html#server" class="glossary-term" title="A program that provides services.">server</a>
<strong>may</strong> re-send <code>COUNTL</code> to confirm this.  If <em>index</em> is greater
than the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a>&#x2019;s last received <code>COUNTL</code>, the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a> <strong>should</strong>
request a <code>dump</code> to fill in the missing files.</p>
</dd>
<dt class="hdlist1"><code>EJECTL</code> <em>index</em> <em>hash</em></dt>
<dd>
<p>The playlist has removed an item at index <em>index</em> with the hash <em>hash</em>.
If <em>index</em> is below or equal to the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a>&#x2019;s last received <code>COUNTL</code>,
the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a> <strong>should</strong> presume <code>COUNTL</code> has decreased by one.  The serve
<strong>may</strong> re-send <code>COUNTL</code> to confirm this.  If <em>index</em> is greater than
the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a>&#x2019;s last received <code>COUNTL</code>, or the <em>hash</em> does not match the
<a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a>&#x2019;s observaitions, the <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a> <strong>should</strong> request a <code>dump</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_requests">Requests</h3>
<div class="sect3">
<h4 id="__code_auto_code_changes_the_autoload_style"><code>auto</code> &#x2014; changes the autoload style</h4>
<div class="paragraph">
<p>TODO
==== <code>sel</code> &#x2014; changes the selection
TODO
==== <code>tloadl</code> &#x2014; loads a text item into the list
TODO
==== <code>floadl</code> &#x2014; loads a file item into the list
TODO
==== <code>ejectl</code> &#x2014; removes an item from the list
TODO</p>
</div>
</div>
</div>
</div>
</div>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="player.html" class="navigation navigation-prev " aria-label="Previous page: player/file">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="mux.html" class="navigation navigation-next " aria-label="Next page: mux">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"list","level":"1.3.3.2","depth":3,"next":{"title":"mux","level":"1.3.3.3","depth":3,"path":"protocol/roles/mux.adoc","ref":"protocol/roles/mux.adoc","articles":[]},"previous":{"title":"player/file","level":"1.3.3.1","depth":3,"path":"protocol/roles/player.adoc","ref":"protocol/roles/player.adoc","articles":[]},"dir":"ltr"},"config":{"plugins":[],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"fontSettings":{"theme":"white","family":"serif","size":2},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"links":{"home":null,"about":null,"issues":"https://github.com/UniversityRadioYork/baps3-spec/issues","contribute":"https://github.com/UniversityRadioYork/baps3-spec","custom":{"URY":"https://ury.org.uk"},"sharing":{"google":false,"facebook":false,"twitter":false}},"gitbook":"3.x.x"},"file":{"path":"protocol/roles/list.adoc","mtime":"2016-11-08T22:55:59.000Z","type":"asciidoc"},"gitbook":{"version":"3.2.2","time":"2016-11-08T22:56:39.320Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

