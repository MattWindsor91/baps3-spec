<!DOCTYPE HTML>
<html lang="en">
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>Protocol | BAPS3 Specification</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.0-alpha.8">
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
        
    
    
    <link rel="next" href="../../comms/internal/changes.html" />
    
    
    <link rel="prev" href="../../comms/internal/README.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
    

        
    <div class="book" data-level="4.1.1" data-basepath="../.." data-revision="Wed Mar 18 2015 18:22:12 GMT+0000 (GMT)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
    	
    	
    	

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                        <i class="fa fa-check"></i>
                        
                        Introduction
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="meta/README.html">
            
                
                    <a href="../../meta/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        This document
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="meta/compiling.html">
            
                
                    <a href="../../meta/compiling.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Compiling
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="meta/conventions.html">
            
                
                    <a href="../../meta/conventions.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Conventions
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="rationale/README.html">
            
                
                    <a href="../../rationale/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Rationale
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="services/README.html">
            
                
                    <a href="../../services/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Services
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="services/rationale.html">
            
                
                    <a href="../../services/rationale.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Rationale
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="services/player.html">
            
                
                    <a href="../../services/player.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Player
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="services/playlist.html">
            
                
                    <a href="../../services/playlist.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Playlist
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="services/platform.html">
            
                
                    <a href="../../services/platform.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        Platform
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="services/tracklister.html">
            
                
                    <a href="../../services/tracklister.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        Track Lister
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="services/trackresolver.html">
            
                
                    <a href="../../services/trackresolver.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        Track Resolver
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="services/client.html">
            
                
                    <a href="../../services/client.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.</b>
                        
                        Client
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="services/additional.html">
            
                
                    <a href="../../services/additional.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.8.</b>
                        
                        Additional Services
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="comms/README.html">
            
                
                    <a href="../../comms/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Inter-Service Communications
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="comms/internal/README.html">
            
                
                    <a href="../../comms/internal/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        Internal API
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="4.1.1" data-path="comms/internal/protocol.html">
            
                
                    <a href="../../comms/internal/protocol.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.1.</b>
                        
                        Protocol
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="comms/internal/changes.html">
            
                
                    <a href="../../comms/internal/changes.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.2.</b>
                        
                        API Changes
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="comms/external/README.html">
            
                
                    <a href="../../comms/external/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        External API
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="comms/external/composites.html">
            
                
                    <a href="../../comms/external/composites.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.1.</b>
                        
                        Composite Resources
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="features/README.html">
            
                
                    <a href="../../features/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Features
                    </a>
                
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="features/core.html">
            
                
                    <a href="../../features/core.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Core
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="features/fileload.html">
            
                
                    <a href="../../features/fileload.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        FileLoad
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="features/playstop.html">
            
                
                    <a href="../../features/playstop.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        PlayStop
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="features/seek.html">
            
                
                    <a href="../../features/seek.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        Seek
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="features/end.html">
            
                
                    <a href="../../features/end.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        End
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="features/timereport.html">
            
                
                    <a href="../../features/timereport.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                        TimeReport
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="features/playlist.html">
            
                
                    <a href="../../features/playlist.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.7.</b>
                        
                        Playlist
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.8" data-path="features/playlist-autoadvance.html">
            
                
                    <a href="../../features/playlist-autoadvance.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.8.</b>
                        
                        Playlist.AutoAdvance
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5.9" data-path="features/playlist-textitems.html">
            
                
                    <a href="../../features/playlist-textitems.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.9.</b>
                        
                        Playlist.TextItems
                    </a>
                
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="impl/README.html">
            
                
                    <a href="../../impl/README.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        Reference Implementations
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">Published using GitBook</a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <a href="../../GLOSSARY.html" class="btn pull-left" aria-label="Glossary"><i class="fa fa-sort-alpha-asc"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">Share on Twitter</button>
                <button type="button" data-sharing="google-plus" class="button">Share on Google</button>
                <button type="button" data-sharing="facebook" class="button">Share on Facebook</button>
                <button type="button" data-sharing="weibo" class="button">Share on Weibo</button>
                <button type="button" data-sharing="instapaper" class="button">Share on Instapaper</button>
            </div>
        </div>
    </div>
    

    
    
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >BAPS3 Specification</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1>Protocol</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="../../GLOSSARY.html#baps3" class="glossary-term" title="The playout system specified in this document.">BAPS3</a> <a href="../../GLOSSARY.html#internal_api" class="glossary-term" title="The API used for communication between servers.">internal API</a> sits atop a text-based protocol based upon
<a href="http://pubs.opengroup.org/onlinepubs/009604599/utilities/xcu_chap02.html" target="_blank">POSIX shell</a> conventions.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rationale">Rationale</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We use a shell-style protocol because:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It is lightweight and relatively easy to parse;</p>
</li>
<li>
<p>It is a good match for the command-and-arguments style of the <a href="../../GLOSSARY.html#baps3" class="glossary-term" title="The playout system specified in this document.">BAPS3</a>
API;</p>
</li>
<li>
<p>The shell style of escaping is convenient for escaping paths
(especially on Windows, where the single-quote syntax can avoid
needing to escape every backslash in a Windows path), which are
common arguments to <a href="../../GLOSSARY.html#baps3" class="glossary-term" title="The playout system specified in this document.">BAPS3</a> commands (<code>load</code>, <code>enqueue</code>, and so on).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A disadvantage is that it is impossible to perform a context-free
splitting of input into lines; the line-feed character could be
escaped.  However, since the usual transport used by the <a href="../../GLOSSARY.html#baps3" class="glossary-term" title="The playout system specified in this document.">BAPS3</a>
protocol is TCP, and most TCP libraries provide unbuffered input
in chunks which may be smaller or larger than one line, we rarely
need this luxury.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_encoding">Encoding</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <a href="../../GLOSSARY.html#internal_api" class="glossary-term" title="The API used for communication between servers.">internal API</a> is designed to expect requests and responses in
the <a href="http://www.ietf.org/rfc/rfc3629.txt" target="_blank">UTF-8</a> encoding.  However, to allow simple implementations
that operate on a per-byte level, certain uses of UTF-8 beyond the
single-byte (ASCII) range are discouraged.</p>
</div>
<div class="paragraph">
<p>API users <strong>must</strong> support the sending and receiving of all single-byte
UTF-8 character codes (that is, ASCII), and <strong>should</strong> support the
sending and receiving of the full UTF-8 range subject to the
limitations below.</p>
</div>
<div class="sect2">
<h3 id="_limitations">Limitations</h3>
<div class="paragraph">
<p>It is <em>undefined behaviour</em> to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use a whitespace character not in the single-byte subset of UTF-8
to separate words.  (See below for recommendations on
word-separating whitespace.)  This limitation allows implementations
to make use of single-byte whitespace checks for word separation;</p>
</li>
<li>
<p>Backslash-escape a character not in single-byte UTF-8.  (This
should not be necessary, as single- and double-quote modes will
allow these characters to be used without escape.)  This limitation
allows backslash escaping to operate on a single-byte level;</p>
</li>
<li>
<p>Backslash-escape the line-feed character.  This limitation is due
to the special status of line-feed escaping as line continuation in
shell <a href="../../GLOSSARY.html#tokenisation" class="glossary-term" title="The process of converting a raw BAPS3 protocol message into a
sequence of words, by separating on unquoted whitespace, removing
quote delimiters, and expanding escape sequences.">tokenisation</a>, and may change in future when a decision is made
as to the necessity of keeping this status in the API.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>API users <strong>may</strong> make decisions as to how to interpret said undefined
behaviour, but <strong>should not</strong> expect certain behaviour from other
users without consulting the <code>FEATURES</code> flags and <code>OHAI</code> response
for confirmation of said behaviour.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_quoting_and_escaping">Quoting and Escaping</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most characters may be transmitted verbatim via the protocol.
However, in order to allow separation of protocol communications
into the <em>words</em> and <em>commands</em> defined below, <a href="../../GLOSSARY.html#baps3" class="glossary-term" title="The playout system specified in this document.">BAPS3</a> gives special
meaning to certain characters.  This is done according to four
<em>quote modes</em>, specified below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In case of ambiguity, refer to the <a href="http://pubs.opengroup.org/onlinepubs/009604599/utilities/xcu_chap02.html" target="_blank">POSIX shell</a> quoting
standards: we follow that style of quoting with the exception of
disallowing variable and command interpolation (thus, backtick and
dollar are not considered special).
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_unquoted_mode">Unquoted mode</h3>
<div class="paragraph">
<p>A protocol tokeniser <strong>should</strong> start in <em>unquoted</em> mode.  In this
mode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Any run of <em>whitespace characters</em> (see below) separates one word
from the next;</p>
</li>
<li>
<p>A <em>line-feed</em> character (<code>0x0A</code>) separates one command from the
next, and ends any word preceding;</p>
</li>
<li>
<p>A single-quote character (<code>&apos;</code>) begins <em>single-quoted</em> mode;</p>
</li>
<li>
<p>A double-quote character (<code>&quot;</code>) begins <em>double-quoted</em> mode;</p>
</li>
<li>
<p>A backslash character (<code>\</code>) begins <em>escaped</em> mode;</p>
</li>
<li>
<p>Any other character is echoed verbatim.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_whitespace">Whitespace</h4>
<div class="paragraph">
<p>The whitespace characters permitted for word separation <strong>must not</strong>
contain line-feed (<code>0x0A</code>), and <strong>must</strong> contain space (<code>0x20</code>) and
horizontal tab (<code>0x09</code>).  Consequently, API users <strong>should</strong> use the
latter two characters for word separation.  API users <strong>should not</strong>
use multi-byte whitespace characters, for the reasons provided in
<em>Encoding</em>.</p>
</div>
<div class="paragraph">
<p>For implementations in C or C++, the C function <a href="http://pubs.opengroup.org/onlinepubs/009695399/functions/isspace.html" target="_blank">isspace()</a>
<strong>may</strong> be used to identify word-separating whitespace, so long as
line-feed is not interpreted as such.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_single_quoted_mode">Single-quoted mode</h3>
<div class="paragraph">
<p>In single-quoted mode, only the single-quote character is treated
specially, and has the effect of returning to unquoted mode.</p>
</div>
</div>
<div class="sect2">
<h3 id="_double_quoted_mode">Double-quoted mode</h3>
<div class="paragraph">
<p>In double-quoted mode:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A backslash character begins escaped mode;</p>
</li>
<li>
<p>A double-quote character begins unquoted mode;</p>
</li>
<li>
<p>Any other character is echoed verbatim.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_escaped_mode">Escaped mode</h3>
<div class="paragraph">
<p>In escaped mode, any single character is treated verbatim; the mode
then reverts to that in which the backslash beginning escaped mode
was read.</p>
</div>
<div class="paragraph">
<p>To allow implementations which escape single bytes instead of
characters, clients <strong>should not</strong> expect servers to backslash-escape
multiple-byte characters properly, and <strong>should</strong> instead use
single-quoted or double-quoted mode to escape these characters.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_words">Words</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The main protocol element is the <em>word</em>, which is a <em>well-formed</em>
sequence of one or more raw characters delimited by any non-zero run
of <em>unquoted</em> whitespace.  A <em>well-formed</em> word is one that ends in
unquoted mode (quotes must be matched), and does not end with a
backslash.</p>
</div>
<div class="paragraph">
<p>By <em>raw</em> characters, we mean that the criteria for a valid word hold
<em>before</em> <a href="../../GLOSSARY.html#tokenisation" class="glossary-term" title="The process of converting a raw BAPS3 protocol message into a
sequence of words, by separating on unquoted whitespace, removing
quote delimiters, and expanding escape sequences.">tokenisation</a>, and specifically that the special characters
count towards the one-or-more limit.  This means that, while the empty
string is <em>not</em> a valid word, the quoted &apos;empty&apos; string <code>&apos;&apos;</code> is.
Implicitly, the unquoted whitespace characters are not considered to
count towards any words.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
There is <em>no</em> limit on the number of quote mode transitions
inside a single word.  For example, <code>unquoted&quot;double&quot;unquoted&#x2019;single&apos;\
unquoted</code> <strong>should</strong> be considered one word (albeit a pathological
one).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_commands">Commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each communication over the <a href="../../GLOSSARY.html#internal_api" class="glossary-term" title="The API used for communication between servers.">Internal API</a> consists of a <em>command</em>
of one or more words.  The first, mandatory, word is the <em>command
word</em> and unambiguously identifies the command; any further words
are <em>arguments</em> to that command.  In this respect, the <a href="../../GLOSSARY.html#baps3" class="glossary-term" title="The playout system specified in this document.">BAPS3</a> protocol
perfectly mirrors shell usage.</p>
</div>
<div class="paragraph">
<p>Commands are divided into <em>requests</em> and <em>responses</em>.</p>
</div>
<div class="sect2">
<h3 id="_requests">Requests</h3>
<div class="paragraph">
<p><em>Requests</em> are the subset of valid commands that originate from an
API <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a>, and instruct an API <a href="../../GLOSSARY.html#service" class="glossary-term" title="A specific role in the BAPS3 system, usually defined as a group of expected
features.">service</a>.  Request command words
<strong>should</strong> consist of one or more <em>lowercase</em> ASCII characters, and
<strong>may</strong> be quoted.</p>
</div>
</div>
<div class="sect2">
<h3 id="_responses">Responses</h3>
<div class="paragraph">
<p><em>Responses</em> are the subset of valid commands that originate from
an API <a href="../../GLOSSARY.html#service" class="glossary-term" title="A specific role in the BAPS3 system, usually defined as a group of expected
features.">service</a>, and inform an API <a href="../../GLOSSARY.html#client" class="glossary-term" title="A program or user that consumes services.">client</a>.  Response command words
<strong>should</strong> consist of one or more <em>uppercase</em> ASCII characters, and
<strong>may</strong> be quoted.</p>
</div>
</div>
<div class="sect2">
<h3 id="_examples">Examples</h3>
<div class="paragraph">
<p>Following is a non-exhaustive list of test cases for a conformant
<a href="../../GLOSSARY.html#baps3" class="glossary-term" title="The playout system specified in this document.">BAPS3</a> tokeniser.  The input is given as a single string using C-style
escaping (specifically, that used by Go); the output is a
comma-separated list of zero or more brace-delimited, comma-separated
lines.  Each case is given a unique identifier to allow tracing to
implemented automated tests, and a description outlining the
particular behaviour under test.</p>
</div>
<div class="paragraph">
<p>Implementors <strong>may</strong> use these tests as a basis for automated testing of
their implementations of a <a href="../../GLOSSARY.html#baps3" class="glossary-term" title="The playout system specified in this document.">BAPS3</a> tokeniser.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
Implementors automated tests based on this list <strong>should</strong> take
input and output strings from the <em>source form</em> of this page, due to
potential differences in the rendered copy.  See
<a href="../../meta/compiling.html">Compiling</a> for details on how to obtain
the source.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 8%;">
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">ID</th>
<th class="tableblock halign-left valign-top">Input</th>
<th class="tableblock halign-left valign-top">Output</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;&quot;</code></p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Empty string (parsed as whitespace)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Empty line</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;&apos;&apos;\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Empty single-quoted string (parsed as empty string)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">E4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;\&quot;\&quot;\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Empty double-quoted string (parsed as empty string)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">W1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;foo bar baz\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Space-delimited words</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">W2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;foo\tbar\tbaz\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tab-delimited words</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">W3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;foo\rbar\rbaz\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Words delimited by odd, but valid, whitespace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">W4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;silly windows\r\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;silly&quot;, &quot;windows&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CRLF line ending tolerance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">W5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;     abc def\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;abc&quot;, &quot;def&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Leading whitespace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">W6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;ghi jkl     \n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;ghi&quot;, &quot;jkl&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trailing whitespace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">W7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;     mno pqr     \n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;mno&quot;, &quot;pqr&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Surrounding whitespace</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;abc\\\ndef\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;abc\ndef&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backslash escaping</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;\&quot;abc\ndef\&quot;\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;abc\ndef&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double-quoting</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;\&quot;abc\\\ndef\&quot;\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;abc\ndef&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double-quoting with backslash escape</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;&apos;abc\ndef&apos;\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;abc\\\ndef&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single-quoting</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;&apos;abc\\\ndef&apos;\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;abc\\\ndef&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single-quoting with (failed) backslash escape</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;Scare\\\&quot; quotes\\\&quot;\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;Scare\&quot;&quot;, &quot;quotes\&quot;&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backslash-escaped double quote</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;I\\&apos;m free\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;I&#x2019;m&quot;, &quot;free&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Backslash-escaped single quote</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;&apos;hello, I&apos;\\&apos;&apos;m an escaped single quote&apos;\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;hello, I&#x2019;m an escaped single quote&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Single-quoted single quote</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Q9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;\&quot;hello, this is an \\&quot; escaped double quote\&quot;\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;hello, this is an \&quot; escaped double quote&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Double-quoted double quote</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">M1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;first line\nsecond line\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;first&quot;, &quot;line&quot;}, {&quot;second&quot;, &quot;line&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Multiple lines in one <a href="../../GLOSSARY.html#tokenisation" class="glossary-term" title="The process of converting a raw BAPS3 protocol message into a
sequence of words, by separating on unquoted whitespace, removing
quote delimiters, and expanding escape sequences.">tokenisation</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">U1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;&#x5317;&#x91CE; &#x6B66;\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;&#x5317;&#x91CE;&quot;, &quot;&#x6B66;&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Valid UTF-8 (provided the string literals are interpreted as UTF-8,
for example in Go)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">U2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;f\xfcr\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;f\xef\xbf\xbdr&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Invalid UTF-8 (ISO-8859-1, using Go syntax)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&quot;enqueue file \&quot;C:\\\\Users\\\\Test\\\\Artist - Title.mp3\&quot; 1\n&quot;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{&quot;enqueue&quot;, &quot;file&quot;, &quot;C:\\Users\\Test\\Artist - Title.mp3&quot;, &quot;1&quot;}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Representative command with Windows path</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../comms/internal/README.html" class="navigation navigation-prev " aria-label="Previous page: Internal API"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../comms/internal/changes.html" class="navigation navigation-next " aria-label="Next page: API Changes"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":"white","family":"serif","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
